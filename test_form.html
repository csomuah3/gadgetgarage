<!DOCTYPE html>
<html>
<head>
    <title>Test Registration Form</title>
</head>
<body>
    <h2>Simple Registration Test</h2>
    <form id="testForm">
        <div>
            <label>Name:</label>
            <input type="text" name="name" value="Test User" required>
        </div>
        <div>
            <label>Email:</label>
            <input type="email" name="email" value="test@example.com" required>
        </div>
        <div>
            <label>Phone:</label>
            <input type="tel" name="phone_number" value="0123456789" required>
        </div>
        <div>
            <label>Country:</label>
            <select name="country" required>
                <option value="Ghana">Ghana</option>
            </select>
        </div>
        <div>
            <label>City:</label>
            <input type="text" name="city" value="Accra" required>
        </div>
        <div>
            <label>Password:</label>
            <input type="password" name="password" value="testpass123" required>
        </div>
        <input type="hidden" name="role" value="1">
        <button type="submit">Test Register</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('testForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const resultDiv = document.getElementById('result');

            resultDiv.innerHTML = '<p>Submitting...</p>';

            try {
                console.log('Submitting form data:', Object.fromEntries(formData));

                const response = await fetch('./actions/register_user_action.php', {
                    method: 'POST',
                    body: formData
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);

                const text = await response.text();
                console.log('Raw response:', text);

                let result;
                try {
                    result = JSON.parse(text);
                } catch (e) {
                    throw new Error('Invalid JSON response: ' + text);
                }

                resultDiv.innerHTML = '<h3>Result:</h3><pre>' + JSON.stringify(result, null, 2) + '</pre>';

            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = '<h3>Error:</h3><p>' + error.message + '</p>';
            }
        });
    </script>
</body>
</html>